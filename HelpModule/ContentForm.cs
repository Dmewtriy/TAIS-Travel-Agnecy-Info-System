using TAIS__Tourist_Agency_Info_System_.Data.Repositories;

namespace HelpModule
{
    public partial class ContentForm : Form
    {
        public ContentForm(InitRepos repos)
        {
            InitializeComponent();
            PopulateTopics();
        }

        // Метод заполнения дерева тем
        private void PopulateTopics()
        {
            TreeNode root = new TreeNode("АИС «Туристическая компания»");

            root.Nodes.Add(new TreeNode("Общие сведения"));
            root.Nodes.Add(new TreeNode("Маршруты"));
            root.Nodes.Add(new TreeNode("Кадры"));
            root.Nodes.Add(new TreeNode("Роли пользователей"));

            treeViewTopics.Nodes.Add(root);
            treeViewTopics.ExpandAll();

            // Выбор первого узла, если он есть
            if (root.Nodes.Count > 0)
                treeViewTopics.SelectedNode = root.Nodes[0];
        }

        // Обработчик события выбора узла в дереве
        private void TreeViewTopics_AfterSelect(object sender, TreeViewEventArgs e)
        {
            string header = e.Node.Text;
            string text = "";

            switch (header)
            {
                case "АИС «Туристическая компания»":
                    text = "Выберите раздел слева для просмотра информации.";
                    break;

                case "Общие сведения":
                    text = "Туристическая компания организует поездки по международным маршрутам, охватывающим несколько городов одной страны.\n" +
                            "Основными компонентами деятельности являются формирование тургрупп, управление маршрутной сетью и обеспечение полной поддержки туристов.\n\n" +
                            "Особенности маршрутов и групп:\n" +
                            "- За каждой группой закрепляется представитель компании, несущий полную ответственность за качество услуг.\n" +
                            "- В контракте заранее фиксируется размер неустойки за неудобства по вине компании.\n" +
                            "- Данные маршрута включают: пункты пребывания, класс гостиниц и экскурсионную программу.\n" +
                            "- Учет поездок охватывает: состав группы, финансовые параметры, данные о представителе и подробную информацию о перевозчике " +
                            "(рейс, тип самолета, стоимость билетов).";
                    break;

                case "Маршруты":
                    text = "Компания организует туристические поездки по определенным маршрутам в странах мира.\n\n" +
                          "Особенности маршрута:\n" +
                          "- Каждый маршрут проходит по нескольким городам только одной страны.\n" +
                          "- Основные данные: название маршрута, страна, общий срок пребывания.\n" +
                          "- Детализация пунктов (городов):\n" +
                          "  * Название пункта и срок пребывания в нем;\n" +
                          "  * Название и класс гостиницы;\n" +
                          "  * Экскурсионная программа.";
                    break;

                case "Кадры":
                    text = "В компании ведется кадровый учет с использованием унифицированных форм документов " +
                             "(Т-1, Т-2 и др.) и электронной трудовой книжки.\n\n" +
                             "По каждому работнику требуется обеспечить хранение следующих атрибутов:\n" +
                             "1. Персональные данные (ФИО, пол, дата рождения, адрес, стаж, должность).\n" +
                             "   Наименование должности должно соответствовать ОКПДТР 2025.\n" +
                             "2. Даты приема, увольнения и перевода на другую работу.\n" +
                             "3. Место работы.\n" +
                             "4. Должность, профессия, специальность, квалификация, структурное подразделение.\n" +
                             "5. Вид мероприятия (прием, увольнение, перевод).\n" +
                             "6. Основание кадрового мероприятия (дата, номер и вид документа).\n" +
                             "7. Причины прекращения трудового договора.\n\n" +
                             "Сведения об уволенных сотрудниках сохраняются в течение 5 лет.";
                    break;

                case "Роли пользователей":
                    text = "Права доступа в системе разделены по ролям:\n\n" +
                           "1. Руководитель компании — любая информация, касающаяся деятельности компании.\n" +
                           "2. Менеджеры по туризму (специализированы по регионам) — оформление договоров.\n" +
                           "3. Менеджер по формированию турпродукта — ввод и корректировка данных по формированию маршрутов.\n" +
                           "4. Менеджер по учёту кадров — ведение документации по принятию и увольнению сотрудников, смены должностей, оформление трудовых книжек.\n" +
                           "5. Руководитель туристской группы — любая информация, касающаяся сопровождаемой группы.";
                    break;

                default:
                    text = "Информация по данному разделу отсутствует.";
                    break;
            }

            // Вывод текста с форматированием
            richTextBoxContent.Clear();

            // Заголовок жирным
            richTextBoxContent.SelectionFont = new Font("Segoe UI", 12, FontStyle.Bold);
            richTextBoxContent.AppendText(header + "\n\n");

            // Основной текст
            richTextBoxContent.SelectionFont = new Font("Segoe UI", 10, FontStyle.Regular);
            richTextBoxContent.AppendText(text);
        }
    }
}